
name: Astro Site Deploy

on:
  workflow_dispatch:
    inputs:
      branch_to_run_on:
        description: 'Branch to run the workflow on'
        required: true
        default: 'master' # Or your default branch
  push:
    branches:
      - master

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '22.17.0' # formally 18

    - name: Install dependencies
      run: npm ci # or install because install is more common but ci is faster for CI/CD and installs from package-lock.json whereas install installs from package.json which can lead to different versions being installed because package.json allows for version ranges

    - name: Build Astro project
      run: npm run build
# An optional build hook 
    - name: Trigger Netlify deploy
      run: curl -X POST -d '{}' https://api.netlify.com/build_hooks/687049ac33783cc4f91bfea2
